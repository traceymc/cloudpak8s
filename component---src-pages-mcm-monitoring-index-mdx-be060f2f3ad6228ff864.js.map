{"version":3,"sources":["webpack:///./src/pages/mcm/monitoring/index.mdx"],"names":["name","_frontmatter","InlineNotification","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","href","isMDXComponent"],"mappings":"0eAMO,IAEeA,EAFTC,EAAe,GAOtBC,GALgBF,EAKmB,qBALX,SAA6BG,GAEzD,OADAC,QAAQC,KAAK,aAAeL,EAAO,2EAC5B,kBAASG,KAIZG,EAAc,CAClBL,gBAEIM,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGP,E,oIACF,mBACD,OAAO,YAACI,EAAD,KAAeD,EAAiBH,EAAhC,CAAuCO,WAAYA,EAAYC,QAAQ,cAG5E,2hBAQA,gFACF,mBAAGC,WAAW,KAAQ,CAChB,KAAQ,+FADd,wBADE,uGAMA,uQAIA,YAACV,EAAD,CAAoBS,QAAQ,sBAC1B,ucASJ,mBAAGC,WAAW,KAAQ,CACd,KAAQ,gEADhB,uBATI,MAaF,uBAEA,YAACV,EAAD,CAAoBS,QAAQ,sBAC1B,8TAIJ,mBAAGC,WAAW,KAAQ,CACd,KAAQ,+FADhB,iDAJI,qBASF,gEACA,6hBAMA,sBACE,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,cACN,mBAAGA,WAAW,KAAQ,CACZ,KAAQ,6DADlB,oCADM,+GAOF,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,oFAGJ,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,kEAIL,iBAAQ,CACN,MAAS,GAET,kBAAIA,WAAW,MAAf,kGAEF,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,uVAUL,qCAAoB,0BAAYA,WAAW,KAAvB,qBAApB,gFACK,0BAAYA,WAAW,KAAvB,4BADL,QACkF,0BAAYA,WAAW,KAAvB,oBADlF,kEAEsB,0BAAYA,WAAW,KAAvB,mBAFtB,sSAMU,0BAAYA,WAAW,KAAvB,aANV,KAOA,iBAAQ,CACN,MAAS,GAET,kBAAIA,WAAW,MAAf,wHACwB,0BAAYA,WAAW,MAAvB,sBADxB,gBACwG,0BAAYA,WAAW,MAAvB,iBADxG,kCAEO,0BAAYA,WAAW,MAAvB,0BAFP,6GAKF,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,0DAIL,iBAAQ,CACN,MAAS,GAET,kBAAIA,WAAW,MAAf,gEAEF,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,sPAKL,qEACA,YAACV,EAAD,CAAoBS,QAAQ,sBAA5B,sTAMA,iBAAQ,CACN,MAAS,GAET,kBAAIC,WAAW,MAAf,iCAEF,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,0vCA0CL,2DACA,iBAAQ,CACN,MAAS,GAET,kBAAIA,WAAW,MAAf,iCAEF,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,2RAWL,iBAAQ,CACN,MAAS,IAET,kBAAIA,WAAW,MAAf,gPAEmD,0BAAYA,WAAW,MAAvB,WAFnD,OAE+G,0BAAYA,WAAW,MAAvB,aAF/G,iBAIF,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,qPAIL,8KAEA,mEACA,iBAAQ,CACN,MAAS,IAET,kBAAIA,WAAW,MAAf,kCAEF,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,uXAKL,8CACA,sBACE,kBAAIA,WAAW,MAAK,iBAAGC,KAAK,8FAAR,4EAM1BJ,EAAWK,gBAAiB","file":"component---src-pages-mcm-monitoring-index-mdx-be060f2f3ad6228ff864.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/travis/build/ibm-cloud-architecture/cloudpak8s/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst InlineNotification = makeShortcode(\"InlineNotification\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <p>{`This section describes how to enable the monitoring component, after you have completed\ninstalling the core components of Cloud\nPak for Multicloud Management 2.0. The Cloud\nplatform used to test and document the installation here is OpenShift on\nIBM Cloud (ROKS), specifically an OpenShift 4.4 cluster. However, since\nOpenShift 4.3. and 4.4 are available on a variety of platforms, the\ninstructions should be valid on whatever on-premise or cloud platform\nwhere you are running OpenShift supported versions.`}</p>\n    <p>{`The enablement of monitoring is well documented in the\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://www.ibm.com/support/knowledgecenter/en/SSFC4F_2.0.0/install/monitoring_config.html\"\n      }}>{`IBM Knowledge Center`}</a>{`.\nThe installation process documented there uses a mix of the Openshift UI\nand the command line. `}</p>\n    <p>{`As an alternative, this section of the Cloud Pak Playbook describes an\ninstallation exclusively using the command line. With this approach, it\nis possible to automate the installation by incorporating these commands\ninto shell scripts.`}</p>\n    <InlineNotification mdxType=\"InlineNotification\">\n      <p>{`The syntax of the\ncommands in this description was correct at the time of writing.\nHowever, command syntax often changes over time for various reasons.\nIf you\nexperience a command syntax error, please check the IBM Knowledge Center\nor Red Hat OpenShift documentation for the latest syntax and adjust\naccordingly. If thtat does\nnot solve the problem, the authors of this section will respond on a best\nefforts basis if you\n`}<a parentName=\"p\" {...{\n          \"href\": \"https://github.com/ibm-cloud-architecture/cloudpak8s/issues\"\n        }}>{`open a github issue`}</a>{`.`}</p>\n    </InlineNotification>\n    <ul>\n    </ul>\n    <InlineNotification mdxType=\"InlineNotification\">\n      <p>{`This command line based enablement of the monitoring function is only tested and valid for\nclusters running in an online environment. That is, the cluster has access to the internet.\nFor offline or airgapped installations, these instructions will not apply, and you will have\nto follow the\n`}<a parentName=\"p\" {...{\n          \"href\": \"https://www.ibm.com/support/knowledgecenter/en/SSFC4F_2.0.0/install/monitoring_config.html\"\n        }}>{`IBM Knowledge Center Monitoring Configuration`}</a>{`\ndocumentation.`}</p>\n    </InlineNotification>\n    <h2>{`Set up necessary Environment variables`}</h2>\n    <p>{`If you have just completed the installation of the Cloud Pak for Multicloud Management core\ncomponents, you probably already have these environment variables set in your command line\nenvironment. In any case, you should check to make sure they are defined as described below.\nThe final step in this section defines 2 additional environment variables whose values can\nonly be known after the installation of the core components. Be sure to at least define\nthese variables, if you already have the others defined.`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Log in to\n`}<a parentName=\"p\" {...{\n            \"href\": \"https://myibm.ibm.com/products-services/containerlibrary\"\n          }}>{`MyIBM Container Software Library`}</a>{`\nwith your IBMid and password.\nIn the Entitlement keys section, copy the entitlement key to your buffer.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`In your command line, paste this entitlement key into an environment variable.`}</p>\n      </li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`export ENTITLED_REGISTRY_KEY=\"<Paste Your Entitlement Key>\"\n`}</code></pre>\n    <ol {...{\n      \"start\": 3\n    }}>\n      <li parentName=\"ol\">{`Define the other environment variables you will need for the core MCM component installation.`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`export ENTITLED_REGISTRY=\"cp.icr.io\"\nexport ENTITLED_REGISTRY_SECRET=\"ibm-management-pull-secret\"\nexport DOCKER_EMAIL=\"<Your Docker ID email>\"\nexport CP4MCM_NAMESPACE=\"cp4m\"\nexport CP4MCM_BLOCK_STORAGECLASS=\"ibmc-block-gold\"\nexport CP4MCM_FILE_STORAGECLASS=\"ibmc-file-gold\"\nexport CP4MCM_FILE_GID_STORAGECLASS=\"ibmc-file-gold-gid\"\n`}</code></pre>\n    <p>{`The value of `}<inlineCode parentName=\"p\">{`ENTITLED_REGISTRY`}</inlineCode>{` points to IBMâ€™s registry containing the software images. The values\nof the `}<inlineCode parentName=\"p\">{`ENTITLED_REGISTRY_SECRET`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`CP4MCM_NAMESPACE`}</inlineCode>{` are arbitrary. You can use different\nvalues if you want. The `}<inlineCode parentName=\"p\">{`...STORAGECLASS`}</inlineCode>{` variables are populated based on the storage classes\navailable in the OpenShift cluster. The storage classes you have available will vary based on\nthe platform on which you are running your MCM OpenShift cluster.\nTo find the available storage classes in your cluster, enter\nthe command `}<inlineCode parentName=\"p\">{`oc get sc`}</inlineCode>{`.`}</p>\n    <ol {...{\n      \"start\": 4\n    }}>\n      <li parentName=\"ol\">{`Go to your OpenShift Cluster UI, and log in to your cluster. From the pull-down menu in\nthe top right corner, click `}<inlineCode parentName=\"li\">{`Copy Login Command`}</inlineCode>{`, then click `}<inlineCode parentName=\"li\">{`Display Token`}</inlineCode>{`. Copy the command\nline under `}<inlineCode parentName=\"li\">{`Log in with this token`}</inlineCode>{`, paste it into your command line and Enter to log in to your\ncluster. The command line is in the form:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`oc login --token=<your_token> --server=<SERVER_URL>\n`}</code></pre>\n    <ol {...{\n      \"start\": 5\n    }}>\n      <li parentName=\"ol\">{`Define the 2 additional post-install environment variables.`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`export YOUR_CP4MCM_ROUTE=\\`oc -n ibm-common-services get route cp-console --template '{{.spec.host}}'\\`\nexport CP_PASSWORD=\\`oc -n ibm-common-services get secret platform-auth-idp-credentials -o jsonpath='{.data.admin_password}' | base64 -d\\`\n`}</code></pre>\n    <h2>{`Adding the Monitoring Storage Configuration`}</h2>\n    <InlineNotification mdxType=\"InlineNotification\">\nFor each of the commands in the following sections, it is recommended to wait a length of\ntime for each of these commands to fully complete before moving on to the next one. From \nour experience, we recommend a wait time of 3 minutes from the return of one command to\nwhen you should enter the next command.\n    </InlineNotification>\n    <ol {...{\n      \"start\": 4\n    }}>\n      <li parentName=\"ol\">{`Enter the following command:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`oc patch installation.orchestrator.management.ibm.com ibm-management -n $CP4MCM_NAMESPACE --type=json -p=\"[\n {\"op\": \"test\",\n  \"path\": \"/spec/pakModules/1/name\",\n  \"value\": \"monitoring\" },\n {\"op\": \"replace\",\n  \"path\": \"/spec/pakModules/1/config/0/spec\",\n  \"value\": \n    {\n      \"monitoringDeploy\": {\n        \"cnmonitoringimagesource\": {\n          \"deployMCMResources\": true\n        },\n        \"global\": {\n          \"environmentSize\": size0,\n          \"persistence\": {\n            \"storageClassOption\": {\n              \"cassandrabak\": none,\n              \"cassandradata\": $CP4MCM_BLOCK_STORAGECLASS,\n              \"couchdbdata\": $CP4MCM_BLOCK_STORAGECLASS,\n              \"datalayerjobs\": $CP4MCM_BLOCK_STORAGECLASS,\n              \"elasticdata\": $CP4MCM_BLOCK_STORAGECLASS,\n              \"kafkadata\": $CP4MCM_BLOCK_STORAGECLASS,\n              \"zookeeperdata\": $CP4MCM_BLOCK_STORAGECLASS\n            },\n            \"storageSize\": {\n              \"cassandrabak\": 50Gi,\n              \"cassandradata\": 50Gi,\n              \"couchdbdata\": 5Gi,\n              \"datalayerjobs\": 5Gi,\n              \"elasticdata\": 5Gi,\n              \"kafkadata\": 10Gi,\n              \"zookeeperdata\": 1Gi\n            }\n          }\n        }\n      }\n    }\n  }\n]\"\n`}</code></pre>\n    <h2>{`Enabling the Monitoring Component`}</h2>\n    <ol {...{\n      \"start\": 5\n    }}>\n      <li parentName=\"ol\">{`Enter the following command.`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`oc patch installation.orchestrator.management.ibm.com ibm-management -n $CP4MCM_NAMESPACE --type=json -p='[\n {\"op\": \"test\",\n  \"path\": \"/spec/pakModules/1/name\",\n  \"value\": \"monitoring\" },\n {\"op\": \"replace\",\n  \"path\": \"/spec/pakModules/1/enabled\",\n  \"value\": true }\n]'\n`}</code></pre>\n    <ol {...{\n      \"start\": 10\n    }}>\n      <li parentName=\"ol\">{`The enablement of the monitoring component will start a number of additional pods. The\ninstallation will be finished when all those additional pods have started successfully. This\ncommand will report these pods that are not yet in the `}<inlineCode parentName=\"li\">{`Running`}</inlineCode>{` or `}<inlineCode parentName=\"li\">{`Completed`}</inlineCode>{` states yet.`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`oc get po --no-headers=true -A | grep -v 'Running\\\\|Completed\\\\|gateway-kong' | grep 'kube-system\\\\|ibm-common-services\\\\|management-infrastructure-management\\\\|management-monitoring\\\\|management-operations\\\\|management-security-services'\n`}</code></pre>\n    <p>{`   Do not move on to the next command until all the addtional pods have completed. Keep\nrepeating the command above until the list comes back empty.`}</p>\n    <h2>{`Patching the Monitoring Deployable Secret`}</h2>\n    <ol {...{\n      \"start\": 11\n    }}>\n      <li parentName=\"ol\">{`Enter the following commands.`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`export ENTITLED_REGISTRY_DOCKERCONFIG=\\`oc get secret $ENTITLED_REGISTRY_SECRET -n $CP4MCM_NAMESPACE -o jsonpath='{.data.\\\\.dockerconfigjson}'\\`\nexeclog oc patch deployable.app.ibm.com/cnmon-pullsecret-deployable -p \\`echo {\\\\\"spec\\\\\":{\\\\\"template\\\\\":{\\\\\"data\\\\\":{\\\\\".dockerconfigjson\\\\\":\\\\\"$ENTITLED_REGISTRY_DOCKERCONFIG\\\\\"}}}}\\` --type merge -n management-monitoring\n`}</code></pre>\n    <h2>{`Additional Resources`}</h2>\n    <ul>\n      <li parentName=\"ul\"><a href=\"https://www.ibm.com/support/knowledgecenter/en/SSFC4F_2.0.0/install/monitoring_config.html\">IBM Knowledge Center - Cloud Pak for MCM 2.0 Monitoring Configuration</a></li>\n    </ul>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}