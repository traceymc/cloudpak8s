{"version":3,"sources":["webpack:///./src/pages/mcm/bookinfo/index.mdx"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"yeAMO,IAAMA,EAAe,GACtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,E,oIACF,mBACD,OAAO,YAACJ,EAAD,KAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAG5E,mEACA,mDAAkC,sBAAQC,WAAW,KAAnB,wCAAlC,QAAmH,sBAAQA,WAAW,KAAnB,aAAnH,YAA6K,sBAAQA,WAAW,KAAnB,WAA7K,4BAAqP,sBAAQA,WAAW,KAAnB,YAArP,iHAEA,sBACE,kBAAIA,WAAW,MAAf,oCACA,kBAAIA,WAAW,MAAf,sBACA,kBAAIA,WAAW,MAAf,2CACA,kBAAIA,WAAW,MAAf,2BACA,kBAAIA,WAAW,MAAf,0BAEF,8CACA,mIAAkH,kBAAIA,WAAW,KAAI,mBAAGA,WAAW,MAAS,CACtJ,KAAQ,wDADuH,wDAArI,yHAG2B,kBAAIA,WAAW,KAAI,mBAAGA,WAAW,MAAS,CAC/D,KAAQ,6EADgC,6EAH9C,+DAMA,sBACE,kBAAIA,WAAW,MAAf,0GACA,kBAAIA,WAAW,MAAf,yHACA,kBAAIA,WAAW,MAAf,oGAEF,8FACA,0EAAyD,sBAAQA,WAAW,KAAnB,WAAzD,sBACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,iFAIL,4CACA,wEAAuD,kBAAIA,WAAW,KAAI,mBAAGA,WAAW,MAAS,CAC3F,KAAQ,yFAD4D,yFAA1E,6IAEsP,sBAAQA,WAAW,KAAI,mBAAGA,WAAW,UAAa,CAClS,KAAQ,6EAD+P,8EAG7Q,kEACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,wCAEL,yDACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,sDAGL,6DACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,oHAEL,kIAAiH,sBAAQA,WAAW,KAAnB,aAAjH,sDACA,kBAAS,CACP,IAAO,qCACP,IAAO,kBAET,iDACA,oEAAmD,kBAAIA,WAAW,KAAI,mBAAGA,WAAW,MAAS,CACvF,KAAQ,uGADwD,uGAAtE,2IAEkQ,sBAAQA,WAAW,KAAnB,qBAFlQ,gLAIA,kBAAS,CACP,IAAO,yCACP,IAAO,iBAET,uGACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,oCAEL,4GACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,qCAEL,wDACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,mEAEL,oHACF,qBAAKA,WAAW,KAAQ,CAClB,IAAO,0CACP,IAAO,4BAEX,+HACF,qBAAKA,WAAW,KAAQ,CAClB,IAAO,wCACP,IAAO,0BAEX,oGACF,qBAAKA,WAAW,KAAQ,CAClB,IAAO,yCACP,IAAO,mCAEX,wLAKJJ,EAAWK,gBAAiB","file":"component---src-pages-mcm-bookinfo-index-mdx-b84fbca5fe967b69dad0.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/travis/build/ibm-cloud-architecture/cloudpak8s/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2>{`Subscription to a Helm Repository Channel`}</h2>\n    <p>{`In this task, you define a `}<strong parentName=\"p\">{`helm repository subscription channel`}</strong>{` and `}<strong parentName=\"p\">{`subscribe`}</strong>{` to that `}<strong parentName=\"p\">{`channel`}</strong>{`. The channel is of type `}<strong parentName=\"p\">{`HelmRepo`}</strong>{`, meaning that the yaml you create will be deployed and stored in a Helm chart.\nVarious tasks associated are`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Look at the bookinfo application`}</li>\n      <li parentName=\"ul\">{`Deploy the channel`}</li>\n      <li parentName=\"ul\">{`Define the helm repo subscription model`}</li>\n      <li parentName=\"ul\">{`Deploy the subscription`}</li>\n      <li parentName=\"ul\">{`Check the application`}</li>\n    </ul>\n    <h3>{`Bookinfo Application`}</h3>\n    <p>{`You will use bookinfo application to deploy as a helm chart. The application is available as helm chart at `}<em parentName=\"p\"><a parentName=\"em\" {...{\n          \"href\": \"https://github.com/hybrid-ops/subscription-examples\"\n        }}>{`https://github.com/hybrid-ops/subscription-examples`}</a></em>{` along with the required resource definitions. You will this github as helm repository.\nNavigate to bookinfo folder, `}<em parentName=\"p\"><a parentName=\"em\" {...{\n          \"href\": \"https://github.com/hybrid-ops/subscription-examples/tree/master/bookinfo\"\n        }}>{`https://github.com/hybrid-ops/subscription-examples/tree/master/bookinfo`}</a></em>{` for the required prerequsites. This folder has three files`}</p>\n    <ul>\n      <li parentName=\"ul\">{`prereqs.yaml - creates bookinfo namespace and creates the required image policy for bookinfo container`}</li>\n      <li parentName=\"ul\">{`prereqs-ns.yaml - creates the namespaces bookinfo-entitilement and bookinfo-project for the channel and subscriptions`}</li>\n      <li parentName=\"ul\">{`ip.yaml - Creates the required image security policy for the the example bookinfo product page.`}</li>\n    </ul>\n    <p>{`You can copy the files to your local workstation and run the commands`}</p>\n    <p>{`Once, you log in to the OpenShift command line of `}<strong parentName=\"p\">{`MCM Hub`}</strong>{`, run the commands`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`oc apply -f prereqs.yaml\noc apply -f prereqs-ns.yaml\noc apply -f ip.yaml\n`}</code></pre>\n    <h3>{`Create the Channel`}</h3>\n    <p>{`You will use the file, bookinfo-channel.yaml in `}<em parentName=\"p\"><a parentName=\"em\" {...{\n          \"href\": \"https://github.com/hybrid-ops/subscription-examples/tree/master/bookinfo-entitlement\"\n        }}>{`https://github.com/hybrid-ops/subscription-examples/tree/master/bookinfo-entitlement`}</a></em>{` to create the required the channel. You can download the file to run locally. This resource file defines the channel for helm repository `}<strong parentName=\"p\"><a parentName=\"strong\" {...{\n          \"href\": \"https://raw.githubusercontent.com/dymaczew/charts/master/repo/incubator/\"\n        }}>{`https://raw.githubusercontent.com/dymaczew/charts/master/repo/incubator/`}</a></strong></p>\n    <p>{`Log in to the MCM Hub and run the command`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`oc apply -f bookinfo-channel.yaml\n`}</code></pre>\n    <p>{`Check if the channel is created:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`oc project bookinfo-entitlement\noc get channel\n`}</code></pre>\n    <p>{`The output should look equivalent to`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`bookinfo-channel   HelmRepo   https://raw.githubusercontent.com/dymaczew/charts/master/repo/incubator/   122m\n`}</code></pre>\n    <p>{`This also can be varified in the console. Click the hambuger icon -> Manage Applications. Then launch the `}<strong parentName=\"p\">{`Resources`}</strong>{` tab which shows the channel that is just created.`}</p>\n    <img {...{\n      \"src\": \"/assets/img/cp4mcm/mcm-channel.jpg\",\n      \"alt\": \"Channel Image\"\n    }}></img>\n    <h3>{`Create the Subscription`}</h3>\n    <p>{`You will use the file, bookinfo-app.yaml in `}<em parentName=\"p\"><a parentName=\"em\" {...{\n          \"href\": \"https://github.com/hybrid-ops/subscription-examples/blob/master/bookinfo-project/bookinfo-app.yaml\"\n        }}>{`https://github.com/hybrid-ops/subscription-examples/blob/master/bookinfo-project/bookinfo-app.yaml`}</a></em>{` to create the required subscription with a placement policy. If you examine the file, you will find  that the placement rule is set to `}<strong parentName=\"p\">{`environment: Demo`}</strong>{`. So, ensure that label is set on your target cluster where you want the application to deployed to.\nAlso, edit the file to modify the route according to your environment.`}</p>\n    <img {...{\n      \"src\": \"/assets/img/cp4mcm/mcm-modifyroute.jpg\",\n      \"alt\": \"Modify Route\"\n    }}></img>\n    <p>{`After the modification of the route, run the command to deploy the application`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`oc apply -f bookinfo-app.yaml\n`}</code></pre>\n    <p>{`The application should be deployed. You can check if the subscription is propogated`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`oc get appsub --all-namespaces\n`}</code></pre>\n    <p>{`The output will look similar to`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`bookinfo-project   bookinfo-subscription   Propagated   141m\n`}</code></pre>\n    <p>{`You also can check the console. Click the hambuger icon -> Manage Applications -> Overview\n`}<img parentName=\"p\" {...{\n        \"src\": \"/assets/img/cp4mcm/mcm-applications.jpg\",\n        \"alt\": \"Applications Overview\"\n      }}></img></p>\n    <p>{`Now, click the application bookinfo-app to view the various resources involved with the subscription.\n`}<img parentName=\"p\" {...{\n        \"src\": \"/assets/img/cp4mcm/mcm-appdetails.jpg\",\n        \"alt\": \"Application Details\"\n      }}></img></p>\n    <p>{`Hover over the placement rule to see the placement rule of the application\n`}<img parentName=\"p\" {...{\n        \"src\": \"/assets/img/cp4mcm/mcm-appdetails1.jpg\",\n        \"alt\": \"Placement Rule Visualization\"\n      }}></img></p>\n    <p>{`If you donâ€™t see the application propogated, you may have to check the placement rule and ensure the rule matches to at least one cluster in your environment.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}